(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const b="https://cataas.com",j=15,A="counted",P=[{name:"Whiskers",fact:"Loves chasing laser pointers.",personality:"Playful"},{name:"Mittens",fact:"Sleeps 16 hours a day.",personality:"Chill"},{name:"Tiger",fact:"Enjoys climbing curtains.",personality:"Adventurous"},{name:"Shadow",fact:"Hides in boxes.",personality:"Curious"},{name:"Luna",fact:"Purrs loudly when happy.",personality:"Affectionate"}],c=document.getElementById("stack"),C=document.getElementById("summary"),R=document.getElementById("like-count"),T=document.getElementById("liked-grid"),x=document.getElementById("progress-bar"),U=document.getElementById("btn-restart"),M=document.getElementById("loading-screen"),L="/pawmatch/",w=new Audio(`${L}meow.mp3`);let f=[],h=[],l=0,m=0,N=!1;async function z(){const e=await fetch(`${b}/cat?json=true`,{headers:{accept:"application/json"},cache:"no-cache"});if(!e.ok)throw new Error("CATAAS request failed");const t=await e.json();return{id:t.id,url:`${b}/cat/${t.id}`,tags:t.tags??[]}}async function k(e=j){M.style.display="flex",N=!1,C.hidden=!0,c.style.display="none",f=[],h=[],l=0,B(0);for(let t=0;t<e;t++)try{f.push(await z()),await q(120)}catch{f.push({id:`${Date.now()}_${t}`,url:`${b}/cat`,tags:[]})}m=f.length,l=0,await Promise.all(f.map(t=>new Promise(s=>{const i=new Image;i.src=`${t.url}?width=900&height=1200`,i.onload=i.onerror=()=>s()}))),M.style.display="none",c.style.display="",H()}function H(){c.innerHTML="",f.forEach((e,t)=>{const s=document.createElement("div");s.className="card",s.style.zIndex=String(t),s.dataset.url=e.url;const i=document.createElement("div");i.className="card-tagline";const n=document.createElement("img");n.src=`${L}paw.png`,n.alt="Paw",n.className="paw-icon";const a=document.createElement("strong");a.textContent="Find Your Purrfect Match",i.append(n,a),s.appendChild(i);const r=document.createElement("div");r.className="card-img-area";const u=document.createElement("img");u.className="card-img",u.alt="Cat",u.src=`${e.url}?width=900&height=1200`,r.appendChild(u),s.appendChild(r);const g=P[Math.floor(Math.random()*P.length)],p=document.createElement("div");p.className="cat-profile",p.innerHTML=`
      <div><strong>Name:</strong> ${g.name}</div>
      <div><strong>Personality:</strong> ${g.personality}</div>
      <div><em>${g.fact}</em></div>
    `,s.appendChild(p);const y=document.createElement("div");y.className="card-actions";const o=document.createElement("button");o.className="btn btn-ghost";const d=document.createElement("img");d.className="btn-icon",d.alt="Dislike",d.src=`${L}dislike.png`,o.appendChild(d);const E=document.createElement("button");E.className="btn btn-primary";const v=document.createElement("img");v.className="btn-icon",v.alt="Like",v.src=`${L}like.png`,E.appendChild(v),[E,o].forEach(D=>{["pointerdown","pointerup","pointermove"].forEach(_=>D.addEventListener(_,F=>F.stopPropagation()))}),o.addEventListener("click",()=>S(!1)),E.addEventListener("click",()=>S(!0)),y.append(o,E),s.appendChild(y),Y(s),c.appendChild(s)})}function Y(e){let t=0,s=0,i=0,n=0,a=!1;const r=o=>o?.closest?.(".card-actions")!=null,u=o=>{r(o.target)||(a=!0,e.setPointerCapture(o.pointerId),t=o.clientX,s=o.clientY,e.classList.add("moving"),e.classList.remove("like","pass"))},g=o=>{a&&(i=o.clientX-t,n=o.clientY-s,e.style.transform=`translate(${i}px, ${n}px) rotate(${i/18}deg)`,e.style.boxShadow=`0 26px 60px rgba(0,0,0,${Math.min(.55,Math.abs(i)/280)})`,i>20?e.classList.add("like"):e.classList.remove("like"),i<-20?e.classList.add("pass"):e.classList.remove("pass"))},p=o=>{e.classList.remove("moving");const d=e.dataset.url;o&&d&&h.push(d),o&&(w.currentTime=0,w.play().catch(()=>{}),O()),e.remove(),(c.children.length===0||l>=m)&&I()},y=()=>{if(!a)return;a=!1;const o=120;i>o?($(e),e.classList.add("swipe-right"),e.addEventListener("transitionend",()=>p(!0),{once:!0})):i<-o?($(e),e.classList.add("swipe-left"),e.addEventListener("transitionend",()=>p(!1),{once:!0})):(e.style.transform="",e.style.boxShadow="",e.classList.remove("like","pass","moving")),i=n=0};e.addEventListener("pointerdown",u),e.addEventListener("pointermove",g),e.addEventListener("pointerup",y)}function $(e){e&&e.dataset[A]==="1"||(e&&(e.dataset[A]="1"),l=Math.min(l+1,m),B(m?l/m*100:0))}function S(e){const t=c.lastElementChild;if(!t)return;const s=t.dataset.url||null;$(t),requestAnimationFrame(()=>{e&&(w.currentTime=0,w.play().catch(()=>{}),O()),t.classList.add(e?"swipe-right":"swipe-left"),t.addEventListener("transitionend",()=>{e&&s&&h.push(s),t.remove(),(c.children.length===0||l>=m)&&I()},{once:!0}),setTimeout(()=>{document.body.contains(t)&&(e&&s&&h.push(s),t.remove(),(c.children.length===0||l>=m)&&I())},350)})}function O(){const e=document.createElement("div");e.textContent="ðŸŽ‰",Object.assign(e.style,{position:"fixed",left:"50%",top:"55%",fontSize:"4rem",transform:"translate(-50%, -50%)",pointerEvents:"none",zIndex:"9999"}),document.body.appendChild(e),setTimeout(()=>e.remove(),1200)}function I(){N||(N=!0,R.textContent=String(h.length),T.innerHTML="",h.forEach(e=>{const t=document.createElement("img");t.src=`${e}?width=500&height=666`,t.alt="Liked cat",T.appendChild(t)}),c.style.display="none",C.hidden=!1,C.scrollIntoView({behavior:"smooth",block:"start"}))}function B(e){x&&(x.style.width=`${Math.max(0,Math.min(100,e))}%`)}const q=e=>new Promise(t=>setTimeout(t,e));U?.addEventListener("click",()=>k());k().catch(console.error);
