(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const a of n)if(a.type==="childList")for(const r of a.addedNodes)r.tagName==="LINK"&&r.rel==="modulepreload"&&i(r)}).observe(document,{childList:!0,subtree:!0});function s(n){const a={};return n.integrity&&(a.integrity=n.integrity),n.referrerPolicy&&(a.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?a.credentials="include":n.crossOrigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function i(n){if(n.ep)return;n.ep=!0;const a=s(n);fetch(n.href,a)}})();const w="https://cataas.com",U=15,S="counted",T=[{name:"Whiskers",fact:"Loves chasing laser pointers.",personality:"Playful"},{name:"Mittens",fact:"Sleeps 16 hours a day.",personality:"Chill"},{name:"Tiger",fact:"Enjoys climbing curtains.",personality:"Adventurous"},{name:"Shadow",fact:"Hides in boxes.",personality:"Curious"},{name:"Luna",fact:"Purrs loudly when happy.",personality:"Affectionate"}],l=document.getElementById("stack"),b=document.getElementById("summary"),F=document.getElementById("like-count"),A=document.getElementById("liked-grid"),M=document.getElementById("progress-bar"),R=document.getElementById("btn-restart"),L=new Audio("/pawmatch/meow.mp3");let f=[],h=[],c=0,m=0,C=!1;async function _(){const e=await fetch(`${w}/cat?json=true`,{headers:{accept:"application/json"},cache:"no-cache"});if(!e.ok)throw new Error("CATAAS request failed");const t=await e.json();return{id:t.id,url:`${w}/cat/${t.id}`,tags:t.tags??[]}}async function $(e=U){document.getElementById("loading-screen").style.display="flex",C=!1,b.hidden=!0,l.style.display="none",f=[],h=[],c=0,k(0);for(let t=0;t<e;t++)try{f.push(await _()),await z(120)}catch{f.push({id:`${Date.now()}_${t}`,url:`${w}/cat`,tags:[]})}m=f.length,c=0,await Promise.all(f.map(t=>new Promise(s=>{const i=new Image;i.src=`${t.url}?width=900&height=1200`,i.onload=i.onerror=()=>s()}))),document.getElementById("loading-screen").style.display="none",l.style.display="",H()}function H(){l.innerHTML="",f.forEach((e,t)=>{const s=document.createElement("div");s.className="card",s.style.zIndex=String(t),s.dataset.url=e.url;const i=document.createElement("div");i.className="card-tagline";const n=document.createElement("img");n.src=new URL("./paw.png",import.meta.url).toString(),n.alt="Paw",n.className="paw-icon";const a=document.createElement("strong");a.textContent="Find Your Purrfect Match",i.append(n,a),s.appendChild(i);const r=document.createElement("div");r.className="card-img-area";const u=document.createElement("img");u.className="card-img",u.alt="Cat",u.src=`${e.url}?width=900&height=1200`,r.appendChild(u),s.appendChild(r);const g=T[Math.floor(Math.random()*T.length)],p=document.createElement("div");p.className="cat-profile",p.innerHTML=`
      <div><strong>Name:</strong> ${g.name}</div>
      <div><strong>Personality:</strong> ${g.personality}</div>
      <div><em>${g.fact}</em></div>
    `,s.appendChild(p);const y=document.createElement("div");y.className="card-actions";const o=document.createElement("button");o.className="btn btn-ghost";const d=document.createElement("img");d.className="btn-icon",d.alt="Dislike",d.src=new URL("./dislike.png",import.meta.url).toString(),o.appendChild(d);const E=document.createElement("button");E.className="btn btn-primary";const v=document.createElement("img");v.className="btn-icon",v.alt="Like",v.src=new URL("./like.png",import.meta.url).toString(),E.appendChild(v),[E,o].forEach(B=>{["pointerdown","pointerup","pointermove"].forEach(O=>B.addEventListener(O,D=>D.stopPropagation()))}),o.addEventListener("click",()=>P(!1)),E.addEventListener("click",()=>P(!0)),y.append(o,E),s.appendChild(y),j(s),l.appendChild(s)})}function j(e){let t=0,s=0,i=0,n=0,a=!1;const r=o=>o?.closest?.(".card-actions")!=null,u=o=>{r(o.target)||(a=!0,e.setPointerCapture(o.pointerId),t=o.clientX,s=o.clientY,e.classList.add("moving"),e.classList.remove("like","pass"))},g=o=>{a&&(i=o.clientX-t,n=o.clientY-s,e.style.transform=`translate(${i}px, ${n}px) rotate(${i/18}deg)`,e.style.boxShadow=`0 26px 60px rgba(0,0,0,${Math.min(.55,Math.abs(i)/280)})`,i>20?e.classList.add("like"):e.classList.remove("like"),i<-20?e.classList.add("pass"):e.classList.remove("pass"))},p=o=>{e.classList.remove("moving");const d=e.dataset.url;o&&d&&h.push(d),o&&(L.currentTime=0,L.play().catch(()=>{}),x()),e.remove(),(l.children.length===0||c>=m)&&I()},y=()=>{if(!a)return;a=!1;const o=120;i>o?(N(e),e.classList.add("swipe-right"),e.addEventListener("transitionend",()=>p(!0),{once:!0})):i<-o?(N(e),e.classList.add("swipe-left"),e.addEventListener("transitionend",()=>p(!1),{once:!0})):(e.style.transform="",e.style.boxShadow="",e.classList.remove("like","pass","moving")),i=n=0};e.addEventListener("pointerdown",u),e.addEventListener("pointermove",g),e.addEventListener("pointerup",y)}function N(e){e&&e.dataset[S]==="1"||(e&&(e.dataset[S]="1"),c=Math.min(c+1,m),k(m?c/m*100:0))}function P(e){const t=l.lastElementChild;if(!t)return;const s=t.dataset.url||null;N(t),requestAnimationFrame(()=>{e&&(L.currentTime=0,L.play().catch(()=>{}),x()),t.classList.add(e?"swipe-right":"swipe-left"),t.addEventListener("transitionend",()=>{e&&s&&h.push(s),t.remove(),(l.children.length===0||c>=m)&&I()},{once:!0}),setTimeout(()=>{document.body.contains(t)&&(e&&s&&h.push(s),t.remove(),(l.children.length===0||c>=m)&&I())},350)})}function x(){const e=document.createElement("div");e.className="confetti",e.innerHTML="ðŸŽ‰",e.style.position="fixed",e.style.left="50%",e.style.top="55%",e.style.fontSize="5rem",e.style.transform="translate(-50%, -50%)",e.style.pointerEvents="none",e.style.zIndex="9999",document.body.appendChild(e),setTimeout(()=>e.remove(),1200)}function I(){C||(C=!0,F.textContent=String(h.length),A.innerHTML="",h.forEach(e=>{const t=document.createElement("img");t.src=`${e}?width=500&height=666`,t.alt="Liked cat",A.appendChild(t)}),l.style.display="none",b.hidden=!1,b.scrollIntoView({behavior:"smooth",block:"start"}))}function k(e){M&&(M.style.width=`${Math.max(0,Math.min(100,e))}%`)}const z=e=>new Promise(t=>setTimeout(t,e));R?.addEventListener("click",()=>$());$().catch(console.error);
